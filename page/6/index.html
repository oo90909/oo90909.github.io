<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta property="og:type" content="website">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="https://oo90909.github.io/page/6/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="fathergun">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
  
<meta name="generator" content="Hexo 6.3.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Hexo</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"><span class="fa fa-bars"></span></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
        
          <a class="nav-icon" href="/atom.xml" title="RSS Feed"><span class="fa fa-rss"></span></a>
        
        <a class="nav-icon nav-search-btn" title="Search"><span class="fa fa-search"></span></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://oo90909.github.io"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main">
  
    <article id="post-区块链安全/工具使用/mythril" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2024/09/14/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%AE%89%E5%85%A8/%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/mythril/" class="article-date">
  <time class="dt-published" datetime="2024-09-14T10:02:36.513Z" itemprop="datePublished">2024-09-14</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">//ubuntu中打开anaconda命令行的命令：</span><br><span class="line"></span><br><span class="line">source ~/anaconda3/bin/activate</span><br><span class="line"></span><br><span class="line">//想进入python3.10.11的环境，使用命令：</span><br><span class="line">conda activate forMythirl    </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="https://oo90909.github.io/2024/09/14/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%AE%89%E5%85%A8/%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/mythril/" data-id="cm8ofd1bw003zd0ud4bet833g" data-title="" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-区块链安全/人际" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2024/09/06/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%AE%89%E5%85%A8/%E4%BA%BA%E9%99%85/" class="article-date">
  <time class="dt-published" datetime="2024-09-06T09:50:27.949Z" itemprop="datePublished">2024-09-06</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>尊重感：++++</p>
<p>仔细分析对方仔细思考过后奇怪的想法，并给予充分论证的否定，对方得到的尊重感视这个想法的离谱程度而定<br>若之后不这样做了。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://oo90909.github.io/2024/09/06/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%AE%89%E5%85%A8/%E4%BA%BA%E9%99%85/" data-id="cm8ofd1as000od0ud2aln32cq" data-title="" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-区块链安全/计划" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2024/09/06/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%AE%89%E5%85%A8/%E8%AE%A1%E5%88%92/" class="article-date">
  <time class="dt-published" datetime="2024-09-06T01:55:37.628Z" itemprop="datePublished">2024-09-06</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>1H学习桥，看桥的代码<br>1H写书，写完（除了需要配置的）<br>0.5H写报告<br>3H审计</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://oo90909.github.io/2024/09/06/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%AE%89%E5%85%A8/%E8%AE%A1%E5%88%92/" data-id="cm8ofd1at000sd0ud140b1jce" data-title="" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-区块链开发/rust/学习方法" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2024/09/03/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%BC%80%E5%8F%91/rust/%E5%AD%A6%E4%B9%A0%E6%96%B9%E6%B3%95/" class="article-date">
  <time class="dt-published" datetime="2024-09-03T08:48:27.611Z" itemprop="datePublished">2024-09-03</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>先简单讲一下读 Rust 代码的顺序：从 crate 的大纲开始，先了解目标代码能干什么、怎么用；然后学习核心 trait，看看它支持哪些功能；之后再掌握主要的数据结构，开始写一些示例代码；最后围绕自己感兴趣的情景深入阅读。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://oo90909.github.io/2024/09/03/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%BC%80%E5%8F%91/rust/%E5%AD%A6%E4%B9%A0%E6%96%B9%E6%B3%95/" data-id="cm8ofd1b4001ud0ud4mu3a2y0" data-title="" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-区块链安全/CheckList/oracle/oracle" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2024/08/29/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%AE%89%E5%85%A8/CheckList/oracle/oracle/" class="article-date">
  <time class="dt-published" datetime="2024-08-29T07:00:28.463Z" itemprop="datePublished">2024-08-29</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>Is the Oracle using deprecated Chainlink functions?<br>Usage of deprecated Chainlink functions like latestAnswer() might return stale or incorrect data, affecting the integrity of smart contracts.<br>Replace deprecated functions with the current recommended methods to ensure accurate data retrieval from oracles.<br>Is the returned price validated to be non-zero?<br>Price feed might return zero and this must be handled as invalid.<br>Ensure the returned price is not zero.<br>Is the price update time validated?</p>
<p>Price feeds might not be supported in the future. To ensure accurate price usage, it’s vital to regularly check the last update timestamp against a predefined delay.        Implement a mechanism to check the heartbeat of the price feed and compare it against a predefined maximum delay (MAX_DELAY). Adjust the MAX_DELAY variable based on the observed heartbeat.<br>Is there a validation to check if the rollup sequencer is running?<br>The rollup sequencer can become offline, which can lead to potential vulnerabilities due to stale prices.<br>Utilize the sequencer uptime feed to confirm the sequencers are up.<br>Is the Oracle’s TWAP period appropriately set?<br>An inadequately set TWAP (Time-Weighted Average Price) period could be exploited to manipulate prices.<br>Adjust the TWAP period to a duration that mitigates the risk of manipulation while providing timely price updates.<br>Is the desired price feed pair supported across all deployed chains?<br>In multi-chain deployments, it’s crucial to ensure the desired price feed pair is available and consistent across all chains.<br>Review the supported price feed pairs on all chains and ensure they are consistent.<br>Is the heartbeat of the price feed suitable for the use case?<br>A price feed heartbeat that’s too slow might not be suitable for some use cases.<br>Assess the requirements of the use case and ensure the price feed heartbeat aligns with them.<br>Are there any inconsistencies with decimal precision when using different price feeds?<br>Different price feeds might have varying decimal precisions, which can lead to inaccuracies.<br>Ensure that the contract handles potential variations in decimal precision across different price feeds.<br>Is the price feed address hard-coded?<br>Hard-coded price feed addresses can be problematic, especially if they become deprecated or if they’re not accurate in the first place.<br>Review and verify the hardcoded price feed addresses. Consider mechanisms to update the address if required in the future.<br>What happens if oracle price updates are front-run?<br>Oracle price updates can be front-run and cause various problems.<br>Ensure the protocol is not affected in the case where oracle price updates are front-run.<br>How does the system handle potential oracle reverts?<br>Unanticipated oracle reverts can lead to Denial-Of-Service.<br>Implement try&#x2F;catch blocks around oracle calls and have alternative strategies ready.<br>Are the price feeds appropriate for the underlying assets?<br>Using an ETH price feed for stETH or a BTC price feed for WBTC can introduce risks associated with the underlying assets deviating from their pegs.<br>Ensure that the price feeds accurately represent the underlying assets to address potential depeg risks.<br>Is the contract vulnerable to oracle manipulation, especially using spot prices from AMMs?<br>Reliance on AMM spot prices as oracles can be manipulated via flashloan.<br>Choose reliable and tamper-resistant oracle sources. Avoid using spot prices from AMMs directly without additional checks.<br>How does the system address potential inaccuracies during flash crashes?<br>During flash crashes, oracles might return inaccurate prices.<br>Implement checks to ensure that the price returned by the oracle lies within an expected range to guard against potential flash crash vulnerabilities.</p>
<p>Oracle 是否在使用已弃用的 Chainlink 函数？<br>使用诸如 latestAnswer () 等已弃用的 Chainlink 函数可能会返回陈旧或不正确的数据，影响智能合约的完整性。<br>用当前推荐的方法替换已弃用的函数，以确保从预言机准确检索数据。</p>
<p>返回的价格是否经过验证为非零值？<br>价格源可能返回零值，这必须被视为无效。<br>确保返回的价格不为零。</p>
<p>价格更新时间是否经过验证？<br>价格源在未来可能不再受支持。为确保准确使用价格，至关重要的是定期根据预定义的延迟检查最后一次更新的时间戳。<br>实施一种机制来检查价格源的心跳，并将其与预定义的最大延迟（MAX_DELAY）进行比较。根据观察到的心跳调整 MAX_DELAY 变量。</p>
<p>是否有验证来检查汇总排序器是否正在运行？<br>汇总排序器可能会离线，这可能由于价格陈旧而导致潜在的漏洞。<br>利用排序器正常运行时间源来确认排序器已启动。</p>
<p>Oracle 的时间加权平均价格（TWAP）周期设置是否恰当？<br>设置不当的 TWAP 周期可能会被利用来操纵价格。<br>将 TWAP 周期调整为一个既能降低被操纵的风险又能及时提供价格更新的持续时间。</p>
<p>所需的价格源对在所有已部署的链上都受支持吗？<br>在多链部署中，确保所需的价格源对在所有链上都可用且一致至关重要。<br>审查所有链上支持的价格源对，并确保它们是一致的。</p>
<p>价格源的心跳是否适合用例？<br>价格源心跳过慢可能不适合某些用例。<br>评估用例的要求，并确保价格源心跳与之相符。</p>
<p>在使用不同的价格源时，小数精度是否存在任何不一致？<br>不同的价格源可能具有不同的小数精度，这可能导致不准确。<br>确保合约处理不同价格源之间小数精度的潜在变化。</p>
<p>价格源地址是硬编码的吗？<br>硬编码的价格源地址可能会有问题，特别是如果它们被弃用或者一开始就不准确。<br>审查并验证硬编码的价格源地址。考虑在未来需要时更新地址的机制。</p>
<p>如果预言机价格更新被抢先交易会发生什么？<br>预言机价格更新可能会被抢先交易并导致各种问题。<br>确保协议在预言机价格更新被抢先交易的情况下不受影响。</p>
<p>系统如何处理潜在的预言机回滚？<br>意外的预言机回滚可能导致拒绝服务。<br>在预言机调用周围实施 try&#x2F;catch 块，并准备好替代策略。</p>
<p>价格源是否适合基础资产？<br>对 stETH 使用 ETH 价格源或对 WBTC 使用 BTC 价格源可能会引入与基础资产偏离其锚定相关的风险。<br>确保价格源准确代表基础资产，以应对潜在的脱锚风险。</p>
<p>合约是否容易受到预言机操纵，尤其是使用来自 AMM 的现货价格？<br>依赖 AMM 现货价格作为预言机可能会通过闪电贷被操纵。<br>选择可靠且防篡改的预言机来源。避免在没有额外检查的情况下直接使用来自 AMM 的现货价格。</p>
<p>系统如何应对闪崩期间的潜在不准确？<br>在闪崩期间，预言机可能会返回不准确的价格。<br>实施检查以确保预言机返回的价格在预期范围内，以防范潜在的闪崩漏洞。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://oo90909.github.io/2024/08/29/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%AE%89%E5%85%A8/CheckList/oracle/oracle/" data-id="cm8ofd1c5004wd0udea5saun3" data-title="" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-区块链安全/CheckList/lending/lending" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2024/08/29/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%AE%89%E5%85%A8/CheckList/lending/lending/" class="article-date">
  <time class="dt-published" datetime="2024-08-29T02:40:41.818Z" itemprop="datePublished">2024-08-29</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>Will the liquidation process function effectively during rapid market downturns?<br>Failure to liquidate positions during sharp price drops can result in substantial platform losses.<br>Ensure robustness during extreme market conditions.<br>Can a position be liquidated if the loan remains unpaid or if the collateral falls below the required threshold?<br>If positions cannot be liquidated under these circumstances, it poses a risk to lenders who might not recover their funds.<br>Ensure a reliable mechanism for liquidating under-collateralized or defaulting loans to safeguard lenders.<br>Is it possible for a user to gain undue profit from self-liquidation?<br>Self-liquidation profit loopholes can lead to potential system abuse and unintended financial consequences.<br>Audit and test self-liquidation mechanisms to prevent any exploitative behaviors.<br>If token transfers or collateral additions are temporarily paused, can a user still be liquidated, even if they intend to deposit more funds?<br>Unexpected pauses can place users at risk of unwarranted liquidations, despite their willingness to increase collateral.<br>Implement safeguards that protect users from liquidation during operational pauses or interruptions.<br>If liquidations are temporarily suspended, what are the implications when they are resumed?<br>Pausing liquidations can increase the solvency risk and lead to unpredictable behaviors upon resumption.<br>Outline clear protocols for pausing and resuming liquidations, ensuring solvency is maintained.<br>Is it possible for users to manipulate the system by front-running and slightly increasing their collateral to prevent liquidation?<br>Lenders must be prevented from griefing via front-running the liquidation.<br>Ensure it is not possible to prevent liquidators by any means.<br>Are all positions, regardless of size, incentivized adequately for liquidation?<br>Without proper incentives, small positions might be overlooked, leading to inefficiencies.<br>Ensure a balanced incentive structure that motivates liquidators to address positions of all sizes.<br>Is interest considered during Loan-to-Value (LTV) calculation?<br>Omitting interest in LTV calculations can result in inaccurate credit assessments.<br>Include accrued interest in LTV calculations to maintain accurate and fair credit evaluations.<br>Can liquidation and repaying be enabled or disabled simultaneously?<br>Protocols might need to ensure that liquidation and repaying mechanisms are either both active or inactive to maintain consistency.<br>Review protocol logic to allow or disallow liquidation and repaying functions collectively to avoid operational discrepancies.<br>Is it possible to lend and borrow the same token within a single transaction?<br>Protocols that allow the same token to be lent and borrowed in a single transaction may be vulnerable to attacks that exploit rapid price inflation or flash loans to manipulate the system.<br>Protocols should implement constraints to prohibit the same token from being used in a lend and borrow action within the same block or transaction, reducing the risk of flash-loan attacks and other manipulative practices.<br>Is there a scenario where a liquidator might receive a lesser amount than anticipated?<br>Discrepancies in liquidation returns can discourage liquidators and impact system stability.<br>Ensure a clear and consistent calculation mechanism for liquidation rewards.<br>Is it possible for a user to be in a condition where they cannot repay their loan?</p>
<p>Certain scenarios or conditions might prevent a user from repaying their loan, causing them to be perpetually in debt. This can be due to factors such as excessive collateralization, high fees, fluctuating token values, or other unforeseen events.        Review the lending protocol’s logic to ensure there are no conditions that could trap a user in perpetual debt. Implement safeguards to notify or protect users from taking actions that may lead to irrecoverable financial situations.<br>Can the user liquidate their own position with a profit? How can the health ratio change, apart from typical cases such as withdrawal of collateral, taking on additional debt, or a significant drop in the price of collateral?</p>
<p>在市场快速下跌期间，清算流程能否有效运作？<br>在价格急剧下跌期间未能清算头寸可能会导致平台遭受重大损失。<br>确保在极端市场条件下的稳健性。</p>
<p>如果贷款未偿还或者抵押品低于要求的阈值，头寸能否被清算？<br>如果在这些情况下无法清算头寸，这会给可能无法收回资金的贷款人带来风险。<br>确保有一个可靠的机制来清算抵押不足或违约的贷款，以保护贷款人。</p>
<p>用户是否有可能从自我清算中获得不当利润？<br>自我清算利润漏洞可能导致潜在的系统滥用和意外的财务后果。<br>审核并测试自我清算机制，以防止任何可利用的行为。</p>
<p>如果代币转移或抵押品增加被暂时暂停，即使用户打算存入更多资金，他们是否仍会被清算？<br>意外的暂停可能会使用户面临不必要的清算风险，尽管他们愿意增加抵押品。<br>实施保障措施，在操作暂停或中断期间保护用户免受清算。</p>
<p>如果清算被暂时暂停，恢复清算时会有什么影响？<br>暂停清算可能会增加偿付能力风险，并在恢复时导致不可预测的行为。<br>制定明确的暂停和恢复清算的协议，确保维持偿付能力。</p>
<p>用户是否有可能通过抢先交易并稍微增加其抵押品来操纵系统以防止清算？<br>必须防止贷款人通过抢先清算来进行恶意攻击。<br>确保无法通过任何方式阻止清算人。<br>可是这种情况不是对贷款人有利吗？</p>
<p>所有头寸，无论大小，是否都有足够的清算激励？<br>如果没有适当的激励，小头寸可能会被忽视，导致效率低下。<br>确保有一个平衡的激励结构，激励清算人处理各种规模的头寸。</p>
<p>在贷款价值比（LTV）计算中是否考虑利息？<br>在 LTV 计算中忽略利息可能会导致不准确的信用评估。<br>在 LTV 计算中包括应计利息，以保持准确和公平的信用评估。</p>
<p>清算和偿还能否同时启用或禁用？<br>协议可能需要确保清算和偿还机制要么同时处于活动状态，要么同时处于非活动状态，以保持一致性。<br>审查协议逻辑，以允许或禁止清算和偿还功能共同起作用，以避免操作差异。</p>
<p>在单个交易中是否可以借出和借入相同的代币？<br>允许在单个交易中借出和借入相同代币的协议可能容易受到利用快速价格上涨或闪电贷来操纵系统的攻击。<br>协议应实施限制，禁止在同一区块或交易中对同一代币进行借出和借入操作，降低闪电贷攻击和其他操纵行为的风险。</p>
<p>是否存在清算人可能收到比预期更少金额的情况？<br>清算回报的差异可能会使清算人失去积极性，并影响系统稳定性。<br>确保有一个清晰且一致的清算奖励计算机制。</p>
<p>用户是否有可能处于无法偿还贷款的情况？<br>某些情况或条件可能会使用户无法偿还贷款，导致他们永久负债。这可能是由于过度抵押、高额费用、代币价值波动或其他不可预见的事件造成的。审查借贷协议的逻辑，确保不存在可能使用户陷入永久债务的情况。实施保障措施，通知用户或保护用户避免采取可能导致不可挽回的财务状况的行动。</p>
<p>用户能否以盈利的方式清算自己的头寸？除了提取抵押品、承担额外债务或抵押品价格大幅下跌等典型情况外，健康比率如何变化？</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://oo90909.github.io/2024/08/29/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%AE%89%E5%85%A8/CheckList/lending/lending/" data-id="cm8ofd1c4004vd0ud8uu0958s" data-title="" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-javaScript/promise" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2024/08/28/javaScript/promise/" class="article-date">
  <time class="dt-published" datetime="2024-08-28T08:26:37.017Z" itemprop="datePublished">2024-08-28</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        
      
    </div>
    <footer class="article-footer">
      <a data-url="https://oo90909.github.io/2024/08/28/javaScript/promise/" data-id="cm8ofd1ak0007d0ud02is4vxe" data-title="" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-区块链安全/CheckList/AMM/AMM" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2024/08/28/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%AE%89%E5%85%A8/CheckList/AMM/AMM/" class="article-date">
  <time class="dt-published" datetime="2024-08-28T05:59:18.227Z" itemprop="datePublished">2024-08-28</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>AMM&#x2F;DEX</p>
<p>Is hardcoded slippage used?</p>
<p>Using hardcoded slippage can lead to poor trades and freezing user funds during times of high volatility.<br>Allow users to specify the slippage parameter in the actual asset amount which was calculated off-chain.</p>
<p>Is there a deadline protection?<br>Without deadline protection, user transactions are vulnerable to sandwich attacks.<br>Allow a user specify the deadline of the swap.</p>
<p>Is there a validation check for protocol reserves?<br>Protocols may face risks if reserves are not validated and can be lent out, affecting the system’s solvency.<br>Ensure reserve validation logic is in place to safeguard the protocol’s liquidity and overall health.</p>
<p>Does the AMM utilize forked code?<br>Using forked code, especially from known projects like Uniswap, can introduce known vulnerabilities if not updated or audited properly.<br>Review the differences. Utilize tools such as contract-diff.xyz to compare and identify the origin of code snippets.</p>
<p>Are there rounding issues in product constant formulas?<br>Rounding issues in the formulas can lead to inaccuracies or imbalances in token swaps and liquidity provisions.<br>Review the mathematical operations in the AMM’s formulas, ensuring they handle rounding appropriately without introducing vulnerabilities.</p>
<p>Can arbitrary calls be made from user input?<br>Allowing arbitrary calls based on user input can expose the contract to various vulnerabilities.<br>Validate and sanitize user inputs. Avoid executing arbitrary calls based solely on input data.</p>
<p>Is there a mechanism in place to protect against excessive slippage?<br>Without slippage protection, traders might experience unexpected losses due to large price deviations during a trade.<br>Incorporate a slippage parameter that users can set to limit their maximum acceptable slippage.</p>
<p>Does the AMM properly handle tokens of varying decimal configurations and token types?<br>If the AMM doesn’t support tokens with varying decimals or types, it might lead to incorrect calculations and potential losses.<br>Ensure compatibility with tokens of varying decimal places and validate token types before processing them.</p>
<p>Does the AMM support fee-on-transfer tokens?<br>Fee-on-transfer tokens can cause problems because the sending amount and the received amount do not match.<br>Ensure the fee-on-transfer tokens are handled correctly if they are supposed to be supported.</p>
<p>Does the AMM support the rebasing tokens?<br>Rebasing tokens can change the actual balance.<br>Ensure the rebasing tokens are handled correctly if they are supposed to be supported.</p>
<p>Does the protocol calculate minAmountOut before a token swap?Are external oracles used? Is a sandwich attack possible?<br>Protocols integrating AMMs should determine the minAmountOut prior to swaps to avoid unfavorable rates. The source of the rates and potential for manipulation should also be considered.<br>Ensure that the protocol calculates minAmountOut before executing swaps. If external oracles are used, validate their trustworthiness and consider potential vulnerabilities like sandwich attacks.</p>
<p>Does the integrating contract verify the caller address in its callback functions?</p>
<p>Callback functions can be manipulated if they don’t validate the calling contract’s address. This is especially crucial for functions like swap() that involve tokens or assets.<br>Implement checks in the callback functions to validate the address of the calling contract. Additionally, review the logic for any potential bypasses to this check.</p>
<p>Is the slippage calculated on-chain?</p>
<p>ON-chain slippage calculation can be manipulated.<br>Allow users to specify the slippage parameter in the actual asset amount which was calculated off-chain.</p>
<p>Is the slippage parameter enforced at the last step before transferring funds to users?</p>
<p>Enforcing slippage parameters for intermediate swaps but not the final step can result in users receiving less tokens than their specified minimum.<br>Enforce slippage parameter as the last step before transferring funds to users</p>
<p>Callback functions in the external contracts that are called by the swap() function are required to check the address of the calling contract. Does the contract that integrates an AMM callback have this check? Are there any ways to bypass the check?</p>
<p>AMM&#x2F;DEX（自动做市商 &#x2F; 去中心化交易所）<br>是否使用了硬编码的滑点？<br>使用硬编码的滑点可能会导致交易不佳，<br>允许用户在链下计算的实际资产数量中指定滑点参数。</p>
<p>是否有截止日期保护？<br>没有截止日期保护，用户交易容易受到三明治攻击。<br>允许用户指定交易的截止日期。</p>
<p>是否对协议储备进行了验证检查？<br>如果储备未经过验证且可以被借出，协议可能面临风险，影响系统的偿付能力。<br>确保有储备验证逻辑来保障协议的流动性和整体健康。</p>
<p>AMM 是否使用了分叉代码？<br>使用分叉代码，尤其是来自像 Uniswap 这样的知名项目的代码，如果没有正确更新或审计，可能会引入已知漏洞。<br>审查差异。使用像 contract-diff.xyz 这样的工具来比较并识别代码片段的来源。</p>
<p>在产品常数公式中是否存在舍入问题？<br>公式中的舍入问题可能会导致代币交换和流动性提供中的不准确或不平衡。<br>审查 AMM 公式中的数学运算，确保它们适当地处理舍入而不引入漏洞。<br>比如我发现的那个10**decimal作为分母的值然后最后归零</p>
<p>是否可以根据用户输入进行任意调用？<br>允许基于用户输入进行任意调用可能会使合约暴露于各种漏洞。<br>验证并清理用户输入。避免仅根据输入数据执行任意调用。</p>
<p>是否有防止过度滑点的机制？<br>没有滑点保护，交易者可能会由于交易期间的价格大幅偏差而遭受意外损失。<br>引入一个滑点参数，用户可以设置该参数以限制其最大可接受滑点。</p>
<p>AMM 是否正确处理具有不同小数配置和代币类型的代币？<br>如果 AMM 不支持具有不同小数位数或类型的代币，可能会导致错误计算和潜在损失。<br>确保与具有不同小数位数的代币兼容，并在处理代币之前验证代币类型。<br>比如我发现的那个10**decimal作为分母的值然后最后归零</p>
<p>AMM 是否支持转账收费代币？<br>转账收费代币可能会引起问题，因为发送金额和接收金额不匹配。<br>如果应该支持转账收费代币，则确保正确处理它们。<br>就比如收手续费，是否会出问题，感觉这个问题要验证是否有问题需要看很多的逻辑</p>
<p>AMM 是否支持再调整代币？<br>再调整代币可以改变实际余额。<br>如果应该支持再调整代币，则确保正确处理它们。<br>再调整代币是指算法根据市场来增加或者减少token的值（算法稳定币算不算？）</p>
<p>协议在代币交换之前是否计算最小输出量？是否使用了外部预言机？是否可能发生三明治攻击？<br>集成 AMM 的协议应该在交换之前确定最小输出量，以避免不利的汇率。还应考虑汇率的来源和被操纵的可能性。<br>确保协议在执行交换之前计算最小输出量。如果使用外部预言机，验证其可信度并考虑像三明治攻击这样的潜在漏洞。</p>
<p>集成合约在其回调函数中是否验证调用者地址？<br>如果回调函数不验证调用合约的地址，它们可能会被操纵。对于像 swap () 这样涉及代币或资产的函数来说，这一点尤其关键。<br>在回调函数中实施检查以验证调用合约的地址。此外，审查任何可能绕过此检查的逻辑。<br>我的理解是如果验证调用者地址，那么可以防止用户错误传入ETH进来</p>
<p>滑点是在链上计算的吗？<br>链上滑点计算可能会被操纵。<br>允许用户在链下计算的实际资产数量中指定滑点参数。<br>这个指的就是不能让合约自己算出滑点值，要用户指定，或者能在合约中更改滑点值</p>
<p>滑点参数是否在向用户转移资金的最后一步强制执行？<br>在中间交换时执行滑点参数但在最后一步不执行，可能会导致用户收到的代币少于他们指定的最小值。<br>在向用户转移资金的最后一步强制执行滑点参数。</p>
<p>由 swap () 函数调用的外部合约中的回调函数需要检查调用合约的地址。集成 AMM 的合约的回调是否有此检查？是否有任何方法可以绕过此检查？</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://oo90909.github.io/2024/08/28/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%AE%89%E5%85%A8/CheckList/AMM/AMM/" data-id="cm8ofd1c4004ud0udhf7g2sc1" data-title="" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-区块链安全/CheckList/gerneral/gerneral漏洞类型" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2024/08/28/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%AE%89%E5%85%A8/CheckList/gerneral/gerneral%E6%BC%8F%E6%B4%9E%E7%B1%BB%E5%9E%8B/" class="article-date">
  <time class="dt-published" datetime="2024-08-28T05:54:04.412Z" itemprop="datePublished">2024-08-28</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>Types<br>Items<br>Notes<br>General<br>Can the protocol handle ERC20 tokens with decimals other than 18?<br>Not all ERC20 tokens use 18 decimals. Overlooking this can lead to computation errors.<br>Always check and adjust for the decimal count of the ERC20 tokens being handled.</p>
<p>Are there unexpected rewards accruing for user deposited assets?</p>
<p>Some protocols or platforms may provide additional rewards for staked or deposited assets. If these rewards are not properly accounted for or managed, it could lead to discrepancies in the user’s expected vs actual returns.<br>The protocol should have mechanisms in place to track all potential rewards for user deposited assets. Users should be provided with clear interfaces or methods to claim any unexpected rewards to ensure fairness and transparency.</p>
<p>Could direct transfers of funds introduce vulnerabilities?</p>
<p>Direct transfers of assets without using the protocol’s logic can lead to various problems in accounting especially if the accounting relies on balanceOf (or address.balance).<br>Implement the internal accounting so that it is not be affected by direct transfers.</p>
<p>Could the initial deposit introduce any issues?<br>The first deposit can set certain parameters or conditions that subsequent deposits rely on.<br>Test and ensure that the first deposit initializes and sets all necessary parameters correctly.</p>
<p>Are the protocol token pegged to any other asset?<br>The target tokens can be depegged.<br>Ensure the protocol behave as expected during the depeg.</p>
<p>Incompatibility With Fee-on-Transfer Tokens<br>Not all ERC20 tokens are compliant to the ERC20 standard and there are several weird ERC20 tokens (e.g. Fee-On-Transfer tokens, rebasing tokens, tokens with blacklisting).<br>Clarify what kind of tokens are supported and whitelist the ERC20 tokens that the protocol would accept.</p>
<p>What would happen if only 1 wei remains in the pool?<br>Leaving residual amounts can lead to discrepancies in accounting or locked funds.<br>Implement logic to handle minimal residual amounts in the pool.</p>
<p>Is it possible to withdraw in the same transaction of deposit?<br>Protocols often provide various benefits to the depositors based on the deposit amount. This can lead to flashloan-deposit-harvest-withdraw attack cycle.<br>Ensure the withdrawal is protected for some blocks after deposit.</p>
<p>Does the protocol revert on maximum approval to prevent over-allowance?<br>Setting high allowances can make funds vulnerable to abuse; protocols sometimes set max to prevent this risk.<br>Consider implementing a revert on approval functions when an unnecessarily high allowance is set.</p>
<p> Reentrancy</p>
<p>Check if follow the Checks-Effects-Interactions Pattern or use nonReentrant modifier.<br>transferFrom&#x2F;transfer&#x2F;safeTransfer functions can lead to re-entrancy if called on untrusted tokens or hook-on-transfer tokens such as ERC777 and ERC677. And even if the nonReentrant modifier is used, a cross-contract view re-entrancy attack is possible. </p>
<p>Access Control<br>What are the risks if ownership is compromised, and how could it affect different components of the system? Can the owner manipulate tokens and ETH within the contract?</p>
<p>协议能否处理小数位数不是 18 的 ERC20 代币？<br>并非所有的 ERC20 代币都使用 18 位小数。忽视这一点可能会导致计算错误。<br>始终检查并调整正在处理的 ERC20 代币的小数位数。</p>
<p>用户存入的资产是否有意外收益？<br>一些协议或平台可能会为质押或存入的资产提供额外奖励。如果这些奖励没有得到妥善核算或管理，可能会导致用户预期收益与实际收益之间的差异。<br>协议应该有相应的机制来跟踪用户存入资产的所有潜在奖励。应该为用户提供清晰的界面或方法来领取任何意外奖励，以确保公平和透明。</p>
<p>直接转账资金会引入漏洞吗？<br>不使用协议逻辑直接转移资产可能会在记账方面导致各种问题，特别是如果记账依赖于 balanceOf（或 address.balance）。<br>实施内部记账，使其不受直接转账的影响。</p>
<p>初始存款会引入任何问题吗？<br>第一笔存款可以设置后续存款所依赖的某些参数或条件。<br>测试并确保第一笔存款正确地初始化并设置所有必要的参数。</p>
<p>协议代币是否与其他资产挂钩？<br>目标代币可能会脱钩。<br>确保在脱钩期间协议的表现符合预期。<br>与转账收费代币不兼容<br>并非所有的 ERC20 代币都符合 ERC20 标准，并且有一些奇怪的 ERC20 代币（例如转账收费代币、再调整代币、有黑名单的代币）。<br>明确支持哪种类型的代币，并将协议接受的 ERC20 代币列入白名单。</p>
<p>如果池中只剩下 1 wei 会发生什么？<br>留下剩余金额可能会导致记账差异或资金被锁定。<br>实施逻辑来处理池中最小的剩余金额。</p>
<p>是否可以在存款的同一笔交易中取款？<br>协议通常会根据存款金额为存款人提供各种好处。这可能会导致闪电贷 - 存款 - 收获 - 取款的攻击循环。<br>确保取款在存款后的一些区块内受到保护。</p>
<p>协议是否在设置最大批准额度时回退以防止过度授权？<br>设置高授权额度可能会使资金容易受到滥用；协议有时会设置最大值以防止这种风险。<br>考虑在设置不必要的高授权额度时实施批准函数的回退。</p>
<p>重入攻击<br>检查是否遵循检查 - 效果 - 交互模式或使用 nonReentrant 修饰符。<br>如果在不可信的代币或带有转账钩子的代币（如 ERC777 和 ERC677）上调用 transferFrom&#x2F;transfer&#x2F;safeTransfer 函数，可能会导致重入攻击。即使使用了 nonReentrant 修饰符，跨合约视图的重入攻击也是可能的。</p>
<p>访问控制<br>如果所有权被泄露会有什么风险，以及它会如何影响系统的不同组件？所有者能否操纵合约中的代币和 ETH？</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://oo90909.github.io/2024/08/28/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%AE%89%E5%85%A8/CheckList/gerneral/gerneral%E6%BC%8F%E6%B4%9E%E7%B1%BB%E5%9E%8B/" data-id="cm8ofd1c5004yd0udcqbf3rxc" data-title="" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-区块链安全/时间" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2024/08/27/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%AE%89%E5%85%A8/%E6%97%B6%E9%97%B4/" class="article-date">
  <time class="dt-published" datetime="2024-08-27T07:24:08.294Z" itemprop="datePublished">2024-08-27</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>关于时间戳的bug：</p>
<p>交易执行的时间戳是取自用户发起交易的时间戳，还是链上执行的时间戳？</p>
<p>应该是链上执行的时间戳</p>
<p>可以用这个来防止抢跑，即一开始设置一个时间戳，如果交易时的时间超过了这个时间，就无法执行</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://oo90909.github.io/2024/08/27/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%AE%89%E5%85%A8/%E6%97%B6%E9%97%B4/" data-id="cm8ofd1at000rd0ud7zejbtmb" data-title="" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  


  <nav id="page-nav">
    
    <a class="extend prev" rel="prev" href="/page/5/">&laquo; Prev</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/4/">4</a><a class="page-number" href="/page/5/">5</a><span class="page-number current">6</span><a class="page-number" href="/page/7/">7</a><a class="page-number" href="/page/8/">8</a><span class="space">&hellip;</span><a class="page-number" href="/page/21/">21</a><a class="extend next" rel="next" href="/page/7/">Next &raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/uniswap2/" rel="tag">uniswap2</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/uniswap3/" rel="tag">uniswap3</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/uniswap2/" style="font-size: 20px;">uniswap2</a> <a href="/tags/uniswap3/" style="font-size: 10px;">uniswap3</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2025/03/">March 2025</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2025/02/">February 2025</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2025/01/">January 2025</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/12/">December 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/11/">November 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/10/">October 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/09/">September 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/08/">August 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/07/">July 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/06/">June 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/05/">May 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/04/">April 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/03/">March 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/02/">February 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/01/">January 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/12/">December 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/11/">November 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/09/">September 2023</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2025/03/24/%E6%AF%95%E8%AE%BE/%E8%AF%AD%E6%B3%95mapping/%E7%BF%BB%E8%AF%91%E8%A6%81%E7%82%B9/">(no title)</a>
          </li>
        
          <li>
            <a href="/2025/03/23/%E6%AF%95%E8%AE%BE/%E8%AF%AD%E6%B3%95mapping/solidity2/">(no title)</a>
          </li>
        
          <li>
            <a href="/2025/03/20/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%AE%89%E5%85%A8/%E5%8D%8F%E8%AE%AE%E4%B8%8E%E6%A0%87%E5%87%86%E5%BA%93/ERC1155/ERC1155/">EIP712</a>
          </li>
        
          <li>
            <a href="/2025/03/19/solana/%E5%90%84%E7%A7%8D%E7%A8%8B%E5%BA%8F%E8%B4%A6%E6%88%B7%E7%B1%BB%E5%9E%8B/%E5%8E%9F%E7%94%9F%E7%A8%8B%E5%BA%8F/">(no title)</a>
          </li>
        
          <li>
            <a href="/2025/03/17/solana/%E5%90%84%E7%A7%8D%E7%A8%8B%E5%BA%8F%E8%B4%A6%E6%88%B7%E7%B1%BB%E5%9E%8B/%E7%A8%8B%E5%BA%8F%E8%B4%A6%E6%88%B7%E7%B1%BB%E5%9E%8B/">(no title)</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2025 fathergun<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.6.4.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>